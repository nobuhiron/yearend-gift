---
import ItemCard from '../components/ItemCard.astro';
import PriceTitle from '../components/PriceTitle.astro';
import { priceBlockData } from '../data/priceBlockData';
import {
  priceItemData2000less,
  priceItemData4000less,
  priceItemData6000less,
  priceItemData6001over,
} from '../data/priceItemData';
const itemSets = [
  priceItemData2000less,
  priceItemData4000less,
  priceItemData6000less,
  priceItemData6001over,
];

const allItemImages = import.meta.glob(`/src/assets/images/item-*.jpg`, {
  eager: true,
  import: 'default',
}) as Record<string, ImageMetadata>;
const getImageByFileName = (fileName: string) => {
  const key = Object.keys(allItemImages).find((key) =>
    key.endsWith('/' + fileName)
  );
  return key ? allItemImages[key] : null;
};
---

{
  priceBlockData.map((block) => (
    <li id={`price-block-${block.index}`} class='p-price-block'>
      <PriceTitle
        url={block.url}
        priceLow={block.priceLow}
        priceHigh={block.priceHigh}
        index={block.index}
      />
      <div class='p-cards'>
        <ul class={`p-cards__list p-price-block__list _${block.index}`}>
          {itemSets[block.index].map((item, i) => (
            <ItemCard
              image={getImageByFileName(item.fileName)}
              code={item.code}
              title={item.title}
              description={item.description}
              price={item.price}
              index={block.index}
            />
          ))}
        </ul>
      </div>
    </li>
  ))
}
